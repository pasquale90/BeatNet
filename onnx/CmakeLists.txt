cmake_minimum_required(VERSION 3.22)
project(beatnet_infer)

set(CMAKE_CXX_STANDARD 17)

# onnx dependency
set(ORT_DIR "onnxruntime")
include_directories("${ORT_DIR}/include")
link_directories("${ORT_DIR}/lib") 

# libsamplerate dependency
set(LIBSAMPLERATE_DIR libsamplerate)
include_directories("${LIBSAMPLERATE_DIR}/include")
link_directories("${LIBSAMPLERATE_DIR}/bin")
link_directories("${LIBSAMPLERATE_DIR}/lib")

set(FFTW3_DIR fftw)
include_directories("${FFTW3_DIR}")
link_directories("${FFTW3_DIR}")

set(SOURCE_FILES 
    inference.cpp 
    resampler.cpp
    frameprocessor.cpp
    fftprocessor.cpp
    filterbankprocessor.cpp
    logspecutils.cpp
)

include_directories("${CMAKE_CURRENT_SOURCE_DIR}")

add_executable(${PROJECT_NAME} ${SOURCE_FILES})
target_link_libraries(${PROJECT_NAME} PRIVATE onnxruntime samplerate fftw3f)